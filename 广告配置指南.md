# å¾®ä¿¡å°ç¨‹åºæ¿€åŠ±è§†é¢‘å¹¿å‘Šé…ç½®æŒ‡å—

> æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2026å¹´2æœˆ6æ—¥
> ç›®æ ‡ï¼šå¸®åŠ©æ­£ç¡®é…ç½®æ¿€åŠ±è§†é¢‘å¹¿å‘ŠåŠŸèƒ½

---

## ğŸ“‹ ç›®å½•

1. [é”™è¯¯æ’æŸ¥](#é”™è¯¯æ’æŸ¥)
2. [å¹¿å‘Šç”³è¯·æµç¨‹](#å¹¿å‘Šç”³è¯·æµç¨‹)
3. [å¹¿å‘Šå•å…ƒIDè·å–](#å¹¿å‘Šå•å…ƒidè·å–)
4. [ä»£ç é…ç½®](#ä»£ç é…ç½®)
5. [å¸¸è§é”™è¯¯ç ](#å¸¸è§é”™è¯¯ç )
6. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## é”™è¯¯æ’æŸ¥

### å½“å‰é”™è¯¯åˆ†æ

**é”™è¯¯ä¿¡æ¯**ï¼š
```
[AD] å¹¿å‘ŠåŠ è½½å¤±è´¥: {
  errMsg: "no advertisement",
  errDetail: "å¹¿å‘Šå•å…ƒï¼ˆunit-idï¼‰ä¸æ­£ç¡®ï¼Œå¹¿å‘Šå•å…ƒé•¿åº¦å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥å¯¹åº”å¹¿å‘Šç»„ä»¶ã€‚",
  errCode: 1002
}
```

**é”™è¯¯ç 1002å«ä¹‰**ï¼šå¹¿å‘Šå•å…ƒæ— æ•ˆ

**æ ¹æœ¬åŸå› **ï¼šä»£ç ä¸­ä½¿ç”¨äº†å ä½ç¬¦ `adunit-xxxxx`ï¼Œè€ŒéçœŸå®çš„å¹¿å‘Šå•å…ƒIDã€‚

---

## å¹¿å‘Šç”³è¯·æµç¨‹

### ç¬¬1æ­¥ï¼šæ£€æŸ¥å¼€é€šæ¡ä»¶

**æ¿€åŠ±è§†é¢‘å¹¿å‘Šå¼€é€šæ¡ä»¶**ï¼š
- âœ… å°ç¨‹åºç´¯è®¡ç‹¬ç«‹è®¿å®¢ï¼ˆUVï¼‰ä¸ä½äº1000
- âœ… å°ç¨‹åºæ— è¿è§„è®°å½•
- âœ… å·²å®Œæˆå¾®ä¿¡è®¤è¯

**å¦‚ä½•æŸ¥çœ‹ç´¯è®¡UV**ï¼š
1. ç™»å½•å¾®ä¿¡å°ç¨‹åºåå°
2. ç‚¹å‡»å·¦ä¾§èœå•ã€æ¨å¹¿ä¸æœç´¢ã€‘â†’ã€æµé‡ä¸»ã€‘
3. æŸ¥çœ‹é¡µé¢é¡¶éƒ¨çš„ç´¯è®¡UVæ•°æ®

**å¦‚æœä¸æ»¡è¶³æ¡ä»¶**ï¼š
- å»ºè®®é€šè¿‡åˆ†äº«ã€æ¨å¹¿ç­‰æ–¹å¼æå‡å°ç¨‹åºè®¿é—®é‡
- ç­‰å¾…1-2ä¸ªå·¥ä½œæ—¥ï¼Œæ•°æ®ä¼šè‡ªåŠ¨æ›´æ–°
- å¦‚ä»æœ‰ç–‘é—®ï¼Œå¯è”ç³»å¾®ä¿¡å®¢æœ

---

### ç¬¬2æ­¥ï¼šè¿›å…¥æµé‡ä¸»æ¨¡å—

1. ç™»å½•å¾®ä¿¡å°ç¨‹åºåå°ï¼šhttps://mp.weixin.qq.com/
2. ç‚¹å‡»å·¦ä¾§èœå•ã€æ¨å¹¿ä¸æœç´¢ã€‘
3. ç‚¹å‡»ã€æµé‡ä¸»ã€‘
4. å¦‚æœæ»¡è¶³å¼€é€šæ¡ä»¶ï¼Œç‚¹å‡»ã€å¼€é€šã€‘æŒ‰é’®
5. é˜…è¯»åè®®å¹¶åŒæ„

**æ³¨æ„**ï¼š
- å¼€é€šåï¼Œå°ç¨‹åºå¹¿å‘Šç»„ä»¶éœ€ç»è¿‡åˆè§„æ€§å®¡æ ¸æ‰èƒ½åœ¨çº¿ä¸Šå±•ç¤º
- å®¡æ ¸æ—¶é—´ä¸º1ä¸ªå·¥ä½œæ—¥
- å®¡æ ¸æœŸé—´æ— æ³•æ­£å¸¸å±•ç¤ºå¹¿å‘Š

---

### ç¬¬3æ­¥ï¼šåˆ›å»ºæ¿€åŠ±è§†é¢‘å¹¿å‘Šä½

1. åœ¨ã€æµé‡ä¸»ã€‘é¡µé¢ï¼Œç‚¹å‡»ã€å¹¿å‘Šä½ç®¡ç†ã€‘
2. ç‚¹å‡»ã€æ–°å»ºå¹¿å‘Šä½ã€‘æŒ‰é’®
3. é€‰æ‹©ã€æ¿€åŠ±è§†é¢‘å¹¿å‘Šã€‘ç±»å‹
4. å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

**å¿…å¡«é¡¹**ï¼š
- **å¹¿å‘Šä½åç§°**ï¼šå»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°
  - ç¤ºä¾‹ï¼š`é¦–é¡µæ¿€åŠ±è§†é¢‘`ã€`å¤æ´»æ¿€åŠ±è§†é¢‘`ã€`è§£é”é«˜çº§åŠŸèƒ½`

- **å¹¿å‘Šä½æè¿°**ï¼šç®€è¦è¯´æ˜ä½¿ç”¨åœºæ™¯
  - ç¤ºä¾‹ï¼š`åœ¨é¦–é¡µæ¬¡æ•°ç”¨å®Œæ—¶å±•ç¤ºï¼Œç”¨äºè·å–é¢å¤–ä½¿ç”¨æœºä¼š`

**é€‰å¡«é¡¹**ï¼š
- **è¡Œä¸šæ ‡ç­¾**ï¼šé€‰æ‹©ç¬¦åˆä½ å°ç¨‹åºçš„è¡Œä¸šåˆ†ç±»

5. ç‚¹å‡»ã€æäº¤ã€‘æŒ‰é’®

---

### ç¬¬4æ­¥ï¼šæŸ¥çœ‹å¹¿å‘Šå•å…ƒID

åˆ›å»ºæˆåŠŸåï¼Œé¡µé¢ä¼šæ˜¾ç¤ºå¹¿å‘Šå•å…ƒIDï¼š

**æ ¼å¼**ï¼š
```
adunit-xxxxxxxxxxxxxxx
```

**è¯´æ˜**ï¼š
- å‰ç¼€å›ºå®šä¸ºï¼š`adunit-`
- åé¢æ˜¯16ä½æ•°å­—
- æ€»å…±22ä½å­—ç¬¦

**ç¤ºä¾‹**ï¼š
```
adunit-1234567890123456
```

---

## å¹¿å‘Šå•å…ƒIDè·å–

### åœ¨å“ªé‡ŒæŸ¥çœ‹å¹¿å‘Šå•å…ƒID

**æ–¹æ³•1ï¼šå¹¿å‘Šä½ç®¡ç†é¡µé¢ï¼ˆæ¨èï¼‰**
1. ç™»å½•å¾®ä¿¡å°ç¨‹åºåå°
2. ç‚¹å‡»ã€æ¨å¹¿ä¸æœç´¢ã€‘â†’ã€æµé‡ä¸»ã€‘â†’ã€å¹¿å‘Šä½ç®¡ç†ã€‘
3. æ‰¾åˆ°å·²åˆ›å»ºçš„æ¿€åŠ±è§†é¢‘å¹¿å‘Šä½
4. åœ¨å¹¿å‘Šä½è¯¦æƒ…ä¸­æŸ¥çœ‹ã€å¹¿å‘Šå•å…ƒIDã€‘

**æ–¹æ³•2ï¼šä½¿ç”¨è°ƒè¯•å·¥å…·**
1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­
2. æ‰“å¼€ã€è°ƒè¯•å™¨ã€‘â†’ã€Networkã€‘é¢æ¿
3. æŸ¥çœ‹APIè¯·æ±‚ä¸­çš„ `adunitId` å‚æ•°

---

### å¤šä¸ªå¹¿å‘Šå•å…ƒçš„ä½¿ç”¨å»ºè®®

**å»ºè®®æ ¹æ®ä¸åŒåœºæ™¯åˆ›å»ºç‹¬ç«‹çš„å¹¿å‘Šä½**ï¼š

| åœºæ™¯ | å¹¿å‘Šä½åç§° | å¹¿å‘Šå•å…ƒIDç¤ºä¾‹ |
|------|----------|----------------|
| é¦–é¡µå¤æ´» | `é¦–é¡µæ¿€åŠ±è§†é¢‘` | `adunit-home-123456` |
| æ¸¸æˆå¤æ´» | `æ¸¸æˆå¤æ´»` | `adunit-game-789012` |
| è§£é”é«˜çº§åŠŸèƒ½ | `è§£é”é«˜çº§åŠŸèƒ½` | `adunit-unlock-3456789` |
| é¢å¤–æ¬¡æ•° | `é¢å¤–ä½¿ç”¨æœºä¼š` | `adunit-extra-901234` |

**ä¼˜åŠ¿**ï¼š
- ä¾¿äºæ•°æ®ç»Ÿè®¡å’Œåˆ†æ
- ä¸åŒåœºæ™¯çš„æ”¶ç›Šå¯ä»¥åˆ†å¼€è®¡ç®—
- çµæ´»ç®¡ç†ä¸åŒå¹¿å‘Šä½

---

## ä»£ç é…ç½®

### æ–¹æ³•1ï¼šå…¨å±€é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰

åˆ›å»ºé…ç½®æ–‡ä»¶ `config/config.js`ï¼š

```javascript
// config/config.js
/**
 * å°ç¨‹åºé…ç½®æ–‡ä»¶
 * å¼€å‘ç¯å¢ƒä½¿ç”¨å¼€å‘ç¯å¢ƒå¹¿å‘ŠID
 * ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç”Ÿäº§ç¯å¢ƒå¹¿å‘ŠID
 */

const env = wx.getAccountInfoSync().miniProgram.envVersion

const config = {
  // å½“å‰ç¯å¢ƒ
  env: env === 'develop' ? 'development' : 'production',

  // æ¿€åŠ±è§†é¢‘å¹¿å‘Šé…ç½®
  ad: {
    // æ¿€åŠ±è§†é¢‘å¹¿å‘Šå•å…ƒIDï¼ˆæ›¿æ¢ä¸ºçœŸå®çš„å¹¿å‘Šå•å…ƒIDï¼‰
    rewardedVideo: {
      development: 'adunit-dev-1234567890123456',  // å¼€å‘ç¯å¢ƒ
      production: 'adunit-12345678901234567890'    // ç”Ÿäº§ç¯å¢ƒ
    },

    // å¤šä¸ªå¹¿å‘Šä½é…ç½®ï¼ˆæ ¹æ®ä¸åŒåœºæ™¯ï¼‰
    home: {
      development: 'adunit-home-dev-1234567890123456',
      production: 'adunit-home-12345678901234567890'
    },
    unlock: {
      development: 'adunit-unlock-dev-1234567890123456',
      production: 'adunit-unlock-12345678901234567890'
    }
  },

  // è·å–å½“å‰ç¯å¢ƒçš„å¹¿å‘Šå•å…ƒID
  getAdUnitId: function(adName = 'rewardedVideo') {
    const currentEnv = this.env === 'development' ? 'development' : 'production'
    return this.ad[adName][currentEnv]
  }
}

module.exports = config
```

**åœ¨é¡µé¢ä¸­ä½¿ç”¨**ï¼š

```javascript
// pages/index/index.js
const config = require('../../config/config.js')

Page({
  data: {
    adUnitId: ''
  },

  onLoad() {
    // è·å–å¹¿å‘Šå•å…ƒID
    const adUnitId = config.getAdUnitId('rewardedVideo')
    this.setData({ adUnitId })

    console.log('[AD] å¹¿å‘Šå•å…ƒID:', adUnitId)
  },

  initRewardedAd() {
    this.rewardedVideoAd = wx.createRewardedVideoAd({
      adUnitId: this.data.adUnitId
    })

    this.rewardedVideoAd.onLoad(() => {
      console.log('[AD] å¹¿å‘ŠåŠ è½½æˆåŠŸ')
      this.setData({ adLoaded: true })
    })

    this.rewardedVideoAd.onError((err) => {
      console.error('[AD] å¹¿å‘ŠåŠ è½½å¤±è´¥:', err)
      this.handleAdError(err)
    })

    this.rewardedVideoAd.onClose((res) => {
      if (res && res.isEnded) {
        // çœ‹å®Œå¹¿å‘Šï¼Œå‘æ”¾å¥–åŠ±
        this.onAdRewarded()
      } else {
        wx.showToast({
          title: 'æœªçœ‹å®Œå¹¿å‘Šï¼Œæ— å¥–åŠ±',
          icon: 'none'
        })
      }
    })

    // é¢„åŠ è½½å¹¿å‘Š
    this.rewardedVideoAd.load().catch(err => {
      console.error('[AD] é¢„åŠ è½½å¤±è´¥:', err)
    })
  }
})
```

---

### æ–¹æ³•2ï¼šç¯å¢ƒå˜é‡é…ç½®

åœ¨äº‘å¼€å‘æ§åˆ¶å°é…ç½®ç¯å¢ƒå˜é‡ï¼š

1. ç™»å½•å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. ç‚¹å‡»ã€äº‘å¼€å‘ã€‘â†’ã€äº‘å‡½æ•°ã€‘
3. é€‰æ‹©æŸä¸ªäº‘å‡½æ•°ï¼ˆå¦‚ `recordAdWatch`ï¼‰
4. ç‚¹å‡»ã€ç¯å¢ƒå˜é‡ã€‘
5. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|-----|------|
| `AD_UNIT_ID` | `adunit-12345678901234567890` | æ›¿æ¢ä¸ºçœŸå®å¹¿å‘Šå•å…ƒID |

**åœ¨äº‘å‡½æ•°ä¸­ä½¿ç”¨**ï¼š

```javascript
// cloudfunctions/recordAdWatch/index.js
exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext()
  const openid = wxContext.OPENID

  // ä»ç¯å¢ƒå˜é‡è¯»å–å¹¿å‘Šå•å…ƒID
  const adUnitId = process.env.AD_UNIT_ID

  // ä½¿ç”¨ç¯å¢ƒå˜é‡
  const res = await db.collection('ad_logs').add({
    data: {
      _openid: openid,
      adUnitId: adUnitId,  // è®°å½•å®é™…ä½¿ç”¨çš„å¹¿å‘Šå•å…ƒID
      adType: 'rewarded_video',
      createTime: new Date()
    }
  })

  return {
    code: 0,
    message: 'è®°å½•æˆåŠŸ'
  }
}
```

---

## å¸¸è§é”™è¯¯ç 

### é”™è¯¯ç å¯¹ç…§è¡¨

| é”™è¯¯ç  | å«ä¹‰ | å¸¸è§åŸå›  | è§£å†³æ–¹æ¡ˆ |
|--------|------|---------|---------|
| **1000** | åç«¯é”™è¯¯è°ƒç”¨å¤±è´¥ | å¾®ä¿¡æœåŠ¡å™¨å¼‚å¸¸ | ç¨åé‡è¯• |
| **1001** | å‚æ•°é”™è¯¯ | adUnitIdæ ¼å¼é”™è¯¯ | æ£€æŸ¥å¹¿å‘Šå•å…ƒIDæ ¼å¼ |
| **1002** | å¹¿å‘Šå•å…ƒæ— æ•ˆ | å¹¿å‘Šå•å…ƒIDé”™è¯¯æˆ–æœªå®¡æ ¸ | æ£€æŸ¥å¹¿å‘Šå•å…ƒIDã€æŸ¥çœ‹å®¡æ ¸çŠ¶æ€ |
| **1003** | å†…éƒ¨é”™è¯¯ | å¾®ä¿¡å¹¿å‘Šç³»ç»Ÿå¼‚å¸¸ | ç¨åé‡è¯• |
| **1004** | æ— é€‚åˆçš„å¹¿å‘Š | å½“å‰ç”¨æˆ·ä¸é€‚åˆå±•ç¤ºå¹¿å‘Š | å±äºæ­£å¸¸æƒ…å†µï¼Œæä¾›é™çº§æ–¹æ¡ˆ |
| **1005** | å¹¿å‘Šç»„ä»¶å®¡æ ¸ä¸­ | å¹¿å‘Šä½æ­£åœ¨å®¡æ ¸ä¸­ | ç­‰å¾…å®¡æ ¸å®Œæˆï¼ˆ1ä¸ªå·¥ä½œæ—¥ï¼‰ |
| **1006** | å¹¿å‘Šç»„ä»¶è¢«é©³å› | å¹¿å‘Šä½å®¡æ ¸æœªé€šè¿‡ | æŸ¥çœ‹å®¡æ ¸æ„è§å¹¶ä¿®æ”¹ |
| **1007** | å¹¿å‘ŠåŠŸèƒ½å·²è¢«ç¦ç”¨ | å¹¿å‘Šä½è¢«å¾®ä¿¡å…³é—­ | è”ç³»å¾®ä¿¡å®¢æœ |
| **1008** | å¹¿å‘Šå•å…ƒå·²å…³é—­ | å¹¿å‘Šä½è¢«æ‰‹åŠ¨å…³é—­ | åœ¨åå°é‡æ–°å¼€å¯ |

---

### é”™è¯¯ç 1002è¯¦ç»†æ’æŸ¥æ­¥éª¤

**æ­¥éª¤1ï¼šæ£€æŸ¥å¹¿å‘Šå•å…ƒIDæ ¼å¼**
- âœ… å¿…é¡»ä»¥ `adunit-` å¼€å¤´
- âœ… åé¢å¿…é¡»æ˜¯16ä½æ•°å­—
- âœ… æ€»å…±22ä½å­—ç¬¦

**æ­¥éª¤2ï¼šç¡®è®¤å¹¿å‘Šå•å…ƒIDæ¥æº**
- âœ… å¿…é¡»ä»å¾®ä¿¡å°ç¨‹åºåå°è·å–
- âœ… ä¸èƒ½è‡ªå·±ç¼–é€ 
- âœ… ä¸èƒ½ä½¿ç”¨å…¶ä»–å°ç¨‹åºçš„å¹¿å‘ŠID

**æ­¥éª¤3ï¼šæ£€æŸ¥å¹¿å‘Šä½å®¡æ ¸çŠ¶æ€**
1. ç™»å½•å¾®ä¿¡å°ç¨‹åºåå°
2. ç‚¹å‡»ã€æ¨å¹¿ä¸æœç´¢ã€‘â†’ã€æµé‡ä¸»ã€‘â†’ã€å¹¿å‘Šä½ç®¡ç†ã€‘
3. æ‰¾åˆ°æ¿€åŠ±è§†é¢‘å¹¿å‘Šä½
4. æŸ¥çœ‹ã€çŠ¶æ€ã€‘åˆ—ï¼š
   - âœ… å®¡æ ¸é€šè¿‡ï¼ˆç»¿è‰²ï¼‰â†’ å¯ä»¥æ­£å¸¸ä½¿ç”¨
   - â³ å®¡æ ¸ä¸­ï¼ˆé»„è‰²ï¼‰â†’ ç­‰å¾…1ä¸ªå·¥ä½œæ—¥
   - âŒ å®¡æ ¸ä¸é€šè¿‡ï¼ˆçº¢è‰²ï¼‰â†’ æŸ¥çœ‹å®¡æ ¸æ„è§

**æ­¥éª¤4ï¼šç¡®è®¤å°ç¨‹åºå·²å¼€é€šæµé‡ä¸»**
1. ç™»å½•å¾®ä¿¡å°ç¨‹åºåå°
2. ç‚¹å‡»ã€æ¨å¹¿ä¸æœç´¢ã€‘â†’ã€æµé‡ä¸»ã€‘
3. æŸ¥çœ‹é¡µé¢é¡¶éƒ¨ï¼š
   - âœ… å·²å¼€é€š â†’ ç»§ç»­ä¸‹ä¸€æ­¥
   - âŒ æœªå¼€é€š â†’ æ£€æŸ¥ç´¯è®¡UVæ˜¯å¦â‰¥1000

**æ­¥éª¤5ï¼šæ£€æŸ¥ä»£ç ä¸­çš„å¹¿å‘Šå•å…ƒID**
æ‰“å¼€ä»¥ä¸‹æ–‡ä»¶ï¼Œæœç´¢ `adunit-xxxxx`ï¼š
- `pages/index/index.js`
- `cloudfunctions/recordAdWatch/index.js`

æ›¿æ¢ä¸ºçœŸå®çš„å¹¿å‘Šå•å…ƒIDã€‚

---

## æœ€ä½³å®è·µ

### 1. å»¶è¿Ÿåˆå§‹åŒ–ï¼Œä¼˜åŒ–æ€§èƒ½

**ä¸è¦åœ¨ onLoad æ—¶åˆå§‹åŒ–å¹¿å‘Š**ï¼š

```javascript
// âŒ ä¸æ¨è
Page({
  onLoad() {
    this.initRewardedAd()  // é¡µé¢åŠ è½½æ—¶å°±åˆå§‹åŒ–
  }
})

// âœ… æ¨è
Page({
  onLoad() {
    // åªé…ç½®IDï¼Œä¸åˆå§‹åŒ–
    this.setData({ adUnitId: 'adunit-12345678901234567890' })
  },

  // åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»å¹¿å‘Šæ—¶æ‰åˆå§‹åŒ–
  async showRewardedAd() {
    if (!this.rewardedVideoAd) {
      this.initRewardedAd()
    }

    try {
      await this.rewardedVideoAd.show()
    } catch (err) {
      console.error('[AD] å¹¿å‘Šæ˜¾ç¤ºå¤±è´¥:', err)
      wx.showToast({
        title: 'å¹¿å‘ŠåŠ è½½å¤±è´¥',
        icon: 'none'
      })
    }
  }
})
```

---

### 2. æå‰é¢„åŠ è½½å¹¿å‘Š

**åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»å¹¿å‘Šä¹‹å‰é¢„åŠ è½½**ï¼š

```javascript
Page({
  onShow() {
    // é¡µé¢æ˜¾ç¤ºæ—¶é¢„åŠ è½½å¹¿å‘Š
    if (wx.createRewardedVideoAd && !this.data.adLoaded) {
      this.loadAd()
    }
  },

  loadAd() {
    if (!this.rewardedVideoAd) {
      this.initRewardedAd()
    }

    this.rewardedVideoAd.load()
      .then(() => {
        console.log('[AD] å¹¿å‘Šé¢„åŠ è½½æˆåŠŸ')
        this.setData({ adLoaded: true })
      })
      .catch(err => {
        console.log('[AD] å¹¿å‘Šé¢„åŠ è½½å¤±è´¥:', err)
        // é¢„åŠ è½½å¤±è´¥ä¸å½±å“ï¼Œç­‰åˆ°çœŸæ­£éœ€è¦æ—¶å†åŠ è½½
      })
  }
})
```

---

### 3. æä¾›é™çº§æ–¹æ¡ˆ

**å½“å¹¿å‘ŠåŠ è½½å¤±è´¥æ—¶ï¼Œæä¾›å…¶ä»–æ–¹å¼è·å–å¥–åŠ±**ï¼š

```javascript
Page({
  showAdPrompt() {
    wx.showModal({
      title: 'æ¬¡æ•°ä¸è¶³',
      content: 'è§‚çœ‹çŸ­è§†é¢‘å¯è·å–é¢å¤–ä½¿ç”¨æœºä¼š',
      confirmText: 'è§‚çœ‹å¹¿å‘Š',
      cancelText: 'å…¶ä»–æ–¹å¼',
      success: async (res) => {
        if (res.confirm) {
          await this.showRewardedAd()
        } else {
          // æ˜¾ç¤ºå…¶ä»–è·å¾—å¥–åŠ±çš„æ–¹å¼
          this.showAlternativeRewards()
        }
      }
    })
  },

  showAlternativeRewards() {
    wx.showActionSheet({
      itemList: [
        'å®Œæˆæ¯æ—¥ä»»åŠ¡',
        'åˆ†äº«ç»™å¥½å‹',
        'é‚€è¯·ç”¨æˆ·ä½¿ç”¨'
      ],
      success: (res) => {
        switch(res.tapIndex) {
          case 0:
            this.doDailyTask()
            break
          case 1:
            this.shareWithFriend()
            break
          case 2:
            this.inviteUser()
            break
        }
      }
    })
  }
})
```

---

### 4. é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

**å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œé‡è¯•**ï¼š

```javascript
Page({
  data: {
    adError: null,
    retryCount: 0,
    maxRetries: 3
  },

  handleAdError(err) {
    console.error('[AD] å¹¿å‘Šé”™è¯¯:', err)

    this.setData({
      adError: err,
      retryCount: 0
    })

    switch(err.errCode) {
      case 1002:
        this.handleInvalidAdUnit()
        break
      case 1004:
        this.handleNoAdAvailable()
        break
      case 1005:
        this.handleAdUnderReview()
        break
      default:
        this.handleGenericError(err)
    }
  },

  handleInvalidAdUnit() {
    wx.showModal({
      title: 'é…ç½®é”™è¯¯',
      content: 'å¹¿å‘Šå•å…ƒé…ç½®æœ‰è¯¯ï¼Œè¯·è”ç³»å®¢æœ',
      showCancel: false
    })
  },

  handleNoAdAvailable() {
    wx.showToast({
      title: 'æš‚æ— å¹¿å‘Šèµ„æº',
      icon: 'none',
      duration: 2000
    })
  },

  handleAdUnderReview() {
    wx.showToast({
      title: 'å¹¿å‘Šå®¡æ ¸ä¸­ï¼Œè¯·ç¨åå†è¯•',
      icon: 'none',
      duration: 2000
    })
  },

  handleGenericError(err) {
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥é‡è¯•
    if (this.data.retryCount < this.data.maxRetries) {
      const retryAfter = 2000 * (this.data.retryCount + 1)

      wx.showToast({
        title: `å¹¿å‘ŠåŠ è½½å¤±è´¥ï¼Œ${retryAfter/1000}ç§’åé‡è¯•`,
        icon: 'none',
        duration: 2000
      })

      setTimeout(() => {
        this.retryLoadAd()
      }, retryAfter)
    } else {
      // è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°
      wx.showToast({
        title: 'å¹¿å‘Šæš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åå†è¯•',
        icon: 'none'
      })
    }
  },

  retryLoadAd() {
    this.setData({
      retryCount: this.data.retryCount + 1
    })

    this.rewardedVideoAd.load()
      .then(() => {
        this.setData({ retryCount: 0 })
        console.log('[AD] é‡è¯•æˆåŠŸ')
      })
      .catch(err => {
        console.error('[AD] é‡è¯•å¤±è´¥:', err)
      })
  }
})
```

---

### 5. é™åˆ¶å¹¿å‘Šå±•ç¤ºé¢‘ç‡

**é¿å…ç”¨æˆ·é¢‘ç¹è§‚çœ‹å¹¿å‘Šï¼Œå¯¼è‡´å¹¿å‘Šå¡«å……ä¸è¶³**ï¼š

```javascript
// utils/ad-limit.js

const MAX_AD_WATCHES_PER_DAY = 15  // æ¯å¤©æœ€å¤šè§‚çœ‹15æ¬¡å¹¿å‘Š
const AD_WATCH_COOLDOWN = 30000  // ä¸¤æ¬¡å¹¿å‘Šè§‚çœ‹é—´éš”30ç§’

function checkCanWatchAd() {
  const today = new Date().toDateString()
  const savedDate = wx.getStorageSync('ad_date')
  const savedCount = wx.getStorageSync('ad_count')

  // æ£€æŸ¥æ—¥æœŸ
  if (savedDate !== today) {
    wx.setStorageSync('ad_date', today)
    wx.setStorageSync('ad_count', 0)
    return { canWatch: true, remaining: MAX_AD_WATCHES_PER_DAY }
  }

  // æ£€æŸ¥æ¬¡æ•°
  if (savedCount >= MAX_AD_WATCHES_PER_DAY) {
    return { canWatch: false, remaining: 0 }
  }

  // æ£€æŸ¥å†·å´æ—¶é—´
  const lastWatchTime = wx.getStorageSync('last_ad_time')
  const now = Date.now()
  if (lastWatchTime && (now - lastWatchTime) < AD_WATCH_COOLDOWN) {
    const remainingSeconds = Math.ceil((AD_WATCH_COOLDOWN - (now - lastWatchTime)) / 1000)
    return { canWatch: false, reason: 'cooldown', remainingSeconds }
  }

  return { canWatch: true, remaining: MAX_AD_WATCHES_PER_DAY - savedCount }
}

function recordAdWatch() {
  const today = new Date().toDateString()
  const count = wx.getStorageSync('ad_count') || 0

  wx.setStorageSync('ad_date', today)
  wx.setStorageSync('ad_count', count + 1)
  wx.setStorageSync('last_ad_time', Date.now())
}

module.exports = {
  checkCanWatchAd,
  recordAdWatch
}
```

**åœ¨é¡µé¢ä¸­ä½¿ç”¨**ï¼š

```javascript
// pages/index/index.js
const { checkCanWatchAd, recordAdWatch } = require('../../utils/ad-limit')

Page({
  showRewardedAd() {
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥è§‚çœ‹å¹¿å‘Š
    const result = checkCanWatchAd()

    if (!result.canWatch) {
      if (result.reason === 'cooldown') {
        wx.showToast({
          title: `è¯·${result.remainingSeconds}ç§’åå†è¯•`,
          icon: 'none'
        })
      } else {
        wx.showToast({
          title: `ä»Šæ—¥è§‚çœ‹æ¬¡æ•°å·²ç”¨å®Œ`,
          icon: 'none'
        })
      }
      return
    }

    // æ˜¾ç¤ºå¹¿å‘Š...
    this.rewardedVideoAd.show()
      .then(() => {
        // çœ‹å®Œå¹¿å‘Šï¼Œè®°å½•è§‚çœ‹æ¬¡æ•°
        recordAdWatch()
        this.onAdRewarded()
      })
      .catch(err => {
        console.error('[AD] å¹¿å‘Šæ˜¾ç¤ºå¤±è´¥:', err)
        this.handleAdError(err)
      })
  }
})
```

---

## ğŸ¯ é…ç½®æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼Œç¡®ä¿å¹¿å‘Šé…ç½®æ­£ç¡®ï¼š

### å¼€å‘å‰æ£€æŸ¥

- [ ] å°ç¨‹åºç´¯è®¡UV â‰¥ 1000
- [ ] å·²å¼€é€šæµé‡ä¸»åŠŸèƒ½
- [ ] å·²åˆ›å»ºæ¿€åŠ±è§†é¢‘å¹¿å‘Šä½
- [ ] å¹¿å‘Šä½å®¡æ ¸çŠ¶æ€ä¸º"å®¡æ ¸é€šè¿‡"
- [ ] å·²è·å–æ­£ç¡®çš„å¹¿å‘Šå•å…ƒID

### ä»£ç é…ç½®æ£€æŸ¥

- [ ] å·²å°†å ä½ç¬¦ `adunit-xxxxx` æ›¿æ¢ä¸ºçœŸå®å¹¿å‘Šå•å…ƒID
- [ ] å¹¿å‘Šå•å…ƒIDæ ¼å¼æ­£ç¡®ï¼ˆadunit-å¼€å¤´ + 16ä½æ•°å­—ï¼‰
- [ ] å·²å®ç°é”™è¯¯ç 1002çš„å¤„ç†
- [ ] å·²å®ç°æ‰€æœ‰å¹¿å‘Šé”™è¯¯ç çš„å¤„ç†
- [ ] å·²æä¾›é™çº§æ–¹æ¡ˆ

### åŠŸèƒ½æµ‹è¯•æ£€æŸ¥

- [ ] åœ¨çœŸæœºä¸Šæµ‹è¯•å¹¿å‘Šæ˜¾ç¤º
- [ ] æµ‹è¯•å®Œæ•´è§‚çœ‹å¹¿å‘Šåçš„å¥–åŠ±å‘æ”¾
- [ ] æµ‹è¯•ä¸­é€”é€€å‡ºå¹¿å‘Šä¸ç»™å¥–åŠ±
- [ ] æµ‹è¯•å¹¿å‘ŠåŠ è½½å¤±è´¥çš„é‡è¯•æœºåˆ¶
- [ ] æµ‹è¯•é”™è¯¯æç¤ºæ˜¯å¦å‹å¥½

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

### å¦‚æœé—®é¢˜ä»æœªè§£å†³

**1. å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£**
- æ¿€åŠ±è§†é¢‘å¹¿å‘Šæ–‡æ¡£ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/ad/rewarded-video-ad.html

**2. å¾®ä¿¡å¼€æ”¾ç¤¾åŒº**
- å¼€å‘è€…ç¤¾åŒºï¼šhttps://developers.weixin.qq.com/community/

**3. å¾®ä¿¡å®¢æœ**
- å•†åŠ¡é—®é¢˜ï¼šhttps://developers.weixin.qq.com/

**4. è”ç³»æˆ‘ä»¬**
- å¦‚æœæ˜¯æœ¬é¡¹ç›®ä»£ç é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ä»£ç æ³¨é‡Šæˆ–è”ç³»å¼€å‘è€…

---

**æ–‡æ¡£ç»´æŠ¤è€…**ï¼šAI Assistant
**æœ€åæ›´æ–°**ï¼š2026å¹´2æœˆ6æ—¥
